package com.example.voice;

import androidx.annotation.Nullable;
import androidx.appcompat.app.AppCompatActivity;

import android.os.Bundle;
import android.speech.tts.TextToSpeech;
import android.util.Log;
import android.view.View;
import android.widget.Toast;

import java.util.Locale;


public class MainActivity extends AppCompatActivity implements View.OnClickListener {



    private TextToSpeech textToSpeech = null;//创建自带语音对象



    @Override

    protected void onCreate(@Nullable Bundle savedInstanceState) {

        super.onCreate(savedInstanceState);

        setContentView(R.layout.activity_main);

        findViewById(R.id.btn0).setOnClickListener(this);

        initTTS();
    }
    private void initTTS() {

        //实例化自带语音对象

        textToSpeech = new TextToSpeech(this, new TextToSpeech.OnInitListener() {

            @Override

            public void onInit(int status) {

                if (status == textToSpeech.SUCCESS) {

                    // Toast.makeText(MainActivity.this,"成功输出语音",

                    // Toast.LENGTH_SHORT).show();

                    // Locale loc1=new Locale("us");

                    // Locale loc2=new Locale("china");



                    textToSpeech.setPitch(1.0f);//方法用来控制音调

                    textToSpeech.setSpeechRate(1.0f);//用来控制语速



                    //判断是否支持下面两种语言

                    int result1 = textToSpeech.setLanguage(Locale.US);

                    int result2 = textToSpeech.setLanguage(Locale.

                            SIMPLIFIED_CHINESE);

                    boolean a = (result1 == TextToSpeech.LANG_MISSING_DATA || result1 == TextToSpeech.LANG_NOT_SUPPORTED);

                    boolean b = (result2 == TextToSpeech.LANG_MISSING_DATA || result2 == TextToSpeech.LANG_NOT_SUPPORTED);



                    Log.i("zhh_tts", "US支持否？--》" + a +

                            "\nzh-CN支持否》--》" + b);



                } else {

                    Toast.makeText(MainActivity.this, "数据丢失或不支持", Toast.LENGTH_SHORT).show();

                }



            }

        });

    }



    @Override

    public void onClick(View v) {

        if (v.getId() == R.id.btn0) {

            startAuto("正坐");

        }



    }



    private void startAuto(String data) {

        // 设置音调，值越大声音越尖（女生），值越小则变成男声,1.0是常规

        textToSpeech.setPitch(0.5f);

        // 设置语速

        textToSpeech.setSpeechRate(0.3f);

        textToSpeech.speak(data,//输入中文，若不支持的设备则不会读出来

                TextToSpeech.QUEUE_FLUSH, null);



    }



    @Override

    protected void onStop() {

        super.onStop();

        textToSpeech.stop(); // 不管是否正在朗读TTS都被打断

        textToSpeech.shutdown(); // 关闭，释放资源

    }





}
